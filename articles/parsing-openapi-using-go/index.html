<!doctype html><html lang=en><head><script type=application/ld+json>{"@context":"https://schema.org","@type":"NewsArticle","headline":"Parsing OpenAPI files using go","image":["https:\/\/quobix.com\/images\/hero-images\/parsing-openapi-using-golang.png"],"datePublished":"2022-12-13 15:54:43 -0500 -0500","author":{"@type":"Person","name":"Dave Shanley","url":"https://quobix.com/author"}}</script><meta charset=utf-8><link rel=apple-touch-icon sizes=180x180 href=https://quobix.com//apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://quobix.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://quobix.com/favicon-16x16.png><meta name=description content="quobix::vaccum, The worlds fastest OpenAPI linter. Learn how easy and quick it is to parse, read and explore OpenAPI specifications using go and [libopenapi](https://github.com/pb33f/libopenapi)."><meta charset=utf-8><meta name=keywords content="OpenAPI,swagger,linting,linter,vacuum,dave shanley,shanley,code,golang,java,javascript,typescript,quobix,engineer"><link crossorigin=use-credentials rel=manifest href=https://quobix.com/site.webmanifest><meta name=author content="Dave Shanley"><meta name=viewport content="width=device-width,initial-scale=1"><title>quobix: Parsing OpenAPI files using go</title><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-PC979K2")</script><link rel=preload href=https://quobix.com/assets/bundle.js as=script><script src=https://quobix.com/assets/bundle.js></script><style>:root{--global-font-size:17px;--toc-font-size:0.7rem;--breadcrumb-font-size:0.75rem;--childnav-font-size:0.75rem;--nav-font-size:0.95rem;--toc-font-header-size:0.85rem;--rule-item-header-fontsize:1.2rem;--rule-item-header-fontsize-mobile:1rem;--rule-item-details-fontsize:0.8rem;--rule-format-fontsize:0.8rem;--rule-type-fontsize:0.7rem;--rule-severity-fontsize:0.8rem;--rule-recommended-fontsize:0.7rem;--rule-function-fontsize:0.8rem;--rule-recommended-banner-fontsize:1rem;--rule-panel-label:0.7rem;--rule-id-fontsize:2rem;--rule-id-fontsize-mobile:1.3rem;--global-line-height:1.4em;--global-space:10px;--vacuum-navigation-width-v:199px;--vacuum-navigation-width:200px;--font-stack:Menlo, Monaco, Roboto Mono, Lucida Console, Liberation Mono,
            DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace,
            serif;--mono-font-stack:Menlo, Monaco, Roboto Mono, Lucida Console, Liberation Mono,
            DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace,
            serif;--background-color:#0d1117;--background-color-alpha:rgba(13, 17, 23, 0.80);--background-color-alpha-mobile:rgba(13, 17, 23, 0.99);--rule-item-background:rgba(26, 32, 44, 0.51);--rule-recommended-background:rgb(33, 41, 55);--rule-stats-background:#0a0a0a;--rule-item-border:rgba(35, 43, 58, 0.9);--navigation-hover:#b685ff33;--navigation-child-selected:rgba(182, 133, 255, 0.36);--navigation-child-hover:rgba(179, 131, 250, 0.09);--navigation-child-container:linear-gradient(180deg, rgba(0,0,0,1) 0%, rgba(182,133,255,0.2) 50%);--vacuum-online-results-background:linear-gradient(180deg, rgba(13, 17, 23,1) 0%, rgba(223, 222, 225, 0.12) 50%);--page-width:65em;--font-color:#e8e9ed;--invert-font-color:#222225;--secondary-color:#b685ff;--secondary-color-lowalpha:rgba(182, 133, 255, 0.73);--secondary-color-very-lowalpha:rgba(182, 133, 255, 0.23);--secondary-color-shadow:rgb(59, 41, 87);--secondary-color-shadow-mid:rgb(78, 54, 114);--tertiary-color:#a3abba;--terminal-border:rgba(76, 81, 91, 0.5);--terminal-header-background:linear-gradient(90deg, rgba(76, 81, 91, 0.5) 0%, rgba(76, 81, 91, 0.1) 80%);--primary-color:rgba(98, 196, 255, 1.0);--primary-color-lowalpha:rgba(98, 196, 255, 0.6);--error-color:#ff3c74;--error-font-color:#ff246b;--error-color-lowalpha:rgba(255, 60, 116, 0.4);--progress-bar-background:#0a0a0a;--progress-bar-fill:#62c4ff;--code-bg-color:none;--input-style:solid;--display-h1-decoration:none;--bold-text:#b685ff;--terminal-green:#00FF00FF;--terminal-yellow:#fddb00;--hrcolor:#3d3d3d;--code-border:#525252;--string-literal:#fd66e5;--warn-400:#ff6a00;--warn-400-lowalpha:rgba(255, 106, 0, 0.15);--warn-300:#ff9900;--warn-300-lowalpha:rgba(255, 153, 0, 0.05);--warn-200:#ffb700;--warn-200-lowalpha:rgba(255, 183, 0, 0.15);--warn-color:#ffd500;--warn-color-lowalpha:rgba(255, 213, 0, 0.15);--ok-400:#f7ff00;--ok-400-lowalpha:rgba(230, 255, 0, 0.15);--ok-300:#d0ff00;--ok-300-lowalpha:rgba(208, 255, 0, 0.15);--ok-200:#aaff00;--ok-200-lowalpha:rgba(170, 255, 0, 0.15);--ok-color:#1aff00;--ok-color-lowalpha:rgba(170, 255, 0, 0.15)}</style><link rel=stylesheet href=https://quobix.com/assets/syntax.css><link rel=stylesheet href=https://quobix.com/assets/app.css><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Parsing OpenAPI files using go"><meta property="og:description" content="Learn how easy and quick it is to parse, read and explore OpenAPI specifications using go and [libopenapi](https://github.com/pb33f/libopenapi)."><meta property="og:publish_date" content="2022-12-13 15:54:43 -0500 -0500"><meta property="og:url" content="https://quobix.com/articles/parsing-openapi-using-go/"><meta property="og:site_name" content="quobix"><meta property="og:image" content="https://quobix.com/images/hero-images/parsing-openapi-using-golang.png"><meta property="og:image:width" content="1400"><meta property="og:image:height" content="680"><meta property="og:image:secure_url" content="https://quobix.com/images/hero-images/parsing-openapi-using-golang.png"><meta property="og:image:type" content="image/png"><meta property="og:image:alt" content="OpenAPI is simple and easy to parse using go. I'll show you how in five minutes."><meta property="article:author" content="https://quobix.com"><meta property="article:publisher" content="https://quobix.com"><meta property="article:section" content="Software"><meta property="article:published_time" content="2022-12-13 15:54:43 -0500 -0500"><meta property="article:modified_time" content="2022-12-13 15:54:43 -0500 -0500"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@daveshanley"><meta name=twitter:creator content="@daveshanley"><meta name=twitter:label1 content="Written by"><meta name=twitter:data1 content="Dave Shanley"><meta name=twitter:label2 content="Reading time"><meta name=twitter:data2 content="4 minutes"></head><body class=terminal><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PC979K2" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><div class=quobix-header><section class=terminal-nav id=main-navigation><header class=terminal-logo><div class="logo terminal-prompt"><a href=https://quobix.com/>quobix</a></div></header><nav class=terminal-menu id=header-menu><ul itemscope itemtype=http://schema.org/BreadcrumbList><li itemprop=itemListElement itemscope itemtype=http://schema.org/ListItem><a href=https://quobix.com/articles/ itemprop=item class=menu-item><span itemprop=name>Articles</span><meta itemprop=position content="1"></a></li><li itemprop=itemListElement itemscope itemtype=http://schema.org/ListItem><a href=https://quobix.com/author/ itemprop=item class=menu-item><span itemprop=name>Author</span><meta itemprop=position content="2"></a></li><li itemprop=itemListElement itemscope itemtype=http://schema.org/ListItem><a href=https://quobix.com/vacuum/ itemprop=item class=menu-item><span itemprop=name>vacuum</span><meta itemprop=position content="3"></a></li></ul></nav><mobile-nav><ul class=mobile-nav><li class=mobile-nav><a href=https://quobix.com/articles/>Articles</a></li><li class=mobile-nav><a href=https://quobix.com/author/>Author</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/>vacuum</a></li></ul></mobile-nav></section><hr id=top-nav-divider></div><div class=container><div class=main-container><main class=content-container><article class=framed-content><h1 class=article-title>Parsing OpenAPI files using go</h1><time datetime="2022-12-13 15:54:43 -0500 -0500">December 13, 2022</time><div class=article-strapline><em>libopenapi makes it simple and easy to parse OpenAPI specifications.</em></div><section class=article-body><figure><img src=https://quobix.com/images/hero-images/parsing-openapi-using-golang.png alt="OpenAPI is simple and easy to parse using go. I'll show you how in five minutes."><figcaption>OpenAPI is simple and easy to parse using go. I&rsquo;ll show you how in five minutes.</figcaption></figure><p>If you&rsquo;re using go as your application programming language of choice and want to parse an <a href=https://www.openapis.org/>OpenAPI</a>
specification, this guide will help make this a breeze.</p><div class=terminal-card><header>Introducing libopenapi</header><div><p>The library we&rsquo;re going to use in this tutorial is <a href=https://github.com/pb33f/libopenapi>libopenapi</a>.
It&rsquo;s an enterprise-grade, high-performance library for OpenAPI, written in pure go.
It supports OpenAPI 3.1 and 3.0 and Swagger (2.0)</p><p>I&rsquo;m the author of <a href=https://github.com/pb33f/libopenapi>libopenapi</a>. It&rsquo;s the same library
that powers <a href=https://quobix.com/vacuum/>vacuum</a>.</p></div></div><hr><h2 id=1-install-libopenapi-in-your-project>1. Install libopenapi in your project</h2><p>Download the <a href=https://raw.githubusercontent.com/OAI/OpenAPI-Specification/main/examples/v3.0/petstore.yaml>Petstore OpenAPI 3 sample specification</a>
that we&rsquo;re going to be using in this tutorial.</p><terminal-window><terminal-header>download sample petstore OpenAPI file</terminal-header>
<terminal-command command="curl https://raw.githubusercontent.com/OAI/OpenAPI-Specification/main/examples/v3.0/petstore.yaml > petstorev3.json" cliname=curl clicommand=https://raw.githubusercontent.com/OAI/OpenAPI-Specification/main/examples/v3.0/petstore.yaml flags=">"></terminal-command></terminal-window><p>The next step is to install <a href=https://github.com/pb33f/libopenapi>libopenapi</a> in your go application.</p><terminal-window><terminal-header>install libopenapi</terminal-header>
<terminal-command command="go get github.com/pb33f/libopenapi" cliname=go clicommand=get flags></terminal-command></terminal-window><h2 id=2-read-in-the-petstore-openapi-specification>2. Read in the petstore OpenAPI specification</h2><p>Read the petstore OpenAPI spec into a byte slice.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;github.com/pb33f/libopenapi&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// load in the petstore sample OpenAPI specification
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// into a byte slice.
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>petstore</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>ReadFile</span><span class=p>(</span><span class=s>&#34;petstorev3.json&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// create a new Document from from the byte slice.
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>document</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>libopenapi</span><span class=p>.</span><span class=nf>NewDocument</span><span class=p>(</span><span class=nx>petstore</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// if anything went wrong, an error is thrown
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nb>panic</span><span class=p>(</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;cannot create new document: %e&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span></code></pre></div><p class=codesplit>Now we can build an OpenAPI 3 Model from the document.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl>  <span class=c1>// because we know this is a v3 spec, we can build a ready to go model from it.
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>docModel</span><span class=p>,</span> <span class=nx>errors</span> <span class=o>:=</span> <span class=nx>document</span><span class=p>.</span><span class=nf>BuildV3Model</span><span class=p>()</span>
</span></span></code></pre></div><p class=codesplit>If anything goes wrong, print out the errors, then panic.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl>  <span class=c1>// if anything went wrong when building the v3 model, a slice of errors will be returned
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>errors</span><span class=p>)</span> <span class=p>&gt;</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>errors</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;error: %e\n&#34;</span><span class=p>,</span> <span class=nx>errors</span><span class=p>[</span><span class=nx>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=nb>panic</span><span class=p>(</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;cannot create v3 model from document: %d errors reported&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>errors</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span></code></pre></div><p><strong><em>That&rsquo;s it!</em></strong> The model is now <strong>ready</strong>, and we can access it via <code>docModel.Model</code> property.</p><p>Let&rsquo;s explore a little by printing out a list of paths and how many operations they each have.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl>  <span class=k>for</span> <span class=nx>pathName</span><span class=p>,</span> <span class=nx>pathItem</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>docModel</span><span class=p>.</span><span class=nx>Model</span><span class=p>.</span><span class=nx>Paths</span><span class=p>.</span><span class=nx>PathItems</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Path %s has %d operations\n&#34;</span><span class=p>,</span> <span class=nx>pathName</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>pathItem</span><span class=p>.</span><span class=nf>GetOperations</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span></code></pre></div><p>This will print out something like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Path /store/order/{orderId} has 2 operations
</span></span><span class=line><span class=cl>Path /pet/findByStatus has 1 operations
</span></span><span class=line><span class=cl>Path /pet/findByTags has 1 operations
</span></span><span class=line><span class=cl>Path /pet has 2 operations
</span></span><span class=line><span class=cl>Path /pet/{petId}/uploadImage has 1 operations
</span></span><span class=line><span class=cl>Path /user/login has 1 operations
</span></span><span class=line><span class=cl>Path /user has 1 operations
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><p>To explore a little further, we can list out all the <code>Schema</code> definitions found and how many properties they contain.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl>  <span class=k>for</span> <span class=nx>schemaName</span><span class=p>,</span> <span class=nx>schemaProxy</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>docModel</span><span class=p>.</span><span class=nx>Model</span><span class=p>.</span><span class=nx>Components</span><span class=p>.</span><span class=nx>Schemas</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Schema &#39;%s&#39; has %d properties\n&#34;</span><span class=p>,</span> <span class=nx>schemaName</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>schemaProxy</span><span class=p>.</span><span class=nf>Schema</span><span class=p>().</span><span class=nx>Properties</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span></code></pre></div><p>Which will print out something like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Schema &#39;User&#39; has 8 properties
</span></span><span class=line><span class=cl>Schema &#39;Tag&#39; has 2 properties
</span></span><span class=line><span class=cl>Schema &#39;ApiResponse&#39; has 3 properties
</span></span><span class=line><span class=cl>Schema &#39;Order&#39; has 6 properties
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><hr><h2 id=dealing-with-circular-errors-and-resolving-issues>Dealing with circular errors and resolving issues.</h2><p>Schemas in OpenAPI are complex, and each version has a <strong><em>different set of supported properties</em></strong>.</p><p>One of the design attractions of OpenAPI is the ability to use
<a href=http://json-schema.org/understanding-json-schema/structuring.html#ref>references</a> to prevent duplicating the same
code over and over for reusable schemas and other object types.</p><p><a href=https://github.com/pb33f/libopenapi>libopenapi</a> will automatically resolve <a href=http://json-schema.org/>JSON Schema</a>
references when building a model. Some specs use recursive/circular patterns when designing models (which is supported)
but can cause <strong>severe problems</strong> for some tools.</p><p>When <a href=https://github.com/pb33f/libopenapi>libopenapi</a> reads the specification into a model, it automatically
resolves all of those references and will detect anything circular.</p><blockquote><p>A circular reference means the reference loops back around on itself as part of a chain
that runs through direct or polymorphic sub-schemas.</p></blockquote><p>For some specs, this may be by design (like the Stripe OpenAPI specification). However, for others, it may not be desirable.</p><p>If any circular/resolving errors are available when reading the OpenAPI specification,
<a href=https://github.com/pb33f/libopenapi>libopenapi</a> returns them with the <code>BuildV3Model()</code> method.</p><div class="terminal-alert terminal-alert-primary">The errors won&rsquo;t prevent the model from building, you can choose to ignore them if you want.</div><h3 id=1-download-the-stripe-openapi-specification>1. Download the Stripe OpenAPI Specification.</h3><terminal-window><terminal-header>download Stripe OpenAPI specification</terminal-header>
<terminal-command command="curl https://raw.githubusercontent.com/stripe/openapi/master/openapi/spec3.json > stripe.json" cliname=curl clicommand=https://raw.githubusercontent.com/stripe/openapi/master/openapi/spec3.json flags=">"></terminal-command></terminal-window><p>Like earlier, read the bytes and create a new Document using <code>libopenapi.NewDocument().</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// load Stripe OpenAPI specification into 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>stripe</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>ReadFile</span><span class=p>(</span><span class=s>&#34;stripe.json&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// create a new document from Stripe specification bytes
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>document</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>libopenapi</span><span class=p>.</span><span class=nf>NewDocument</span><span class=p>(</span><span class=nx>stripe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// if anything went wrong, an error is thrown
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>panic</span><span class=p>(</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;cannot create new document: %e&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>This spec has several circular errors. Instead of reading and using the model,
we can use errors and cast them <code>*resolver.ResolvingError.</code></p><p>Let&rsquo;s print out some details from the circular references in the Stripe API.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// build a model from the Stripe document, ignore the model, keep the errors
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>_</span><span class=p>,</span> <span class=nx>errors</span> <span class=o>:=</span> <span class=nx>document</span><span class=p>.</span><span class=nf>BuildV3Model</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// loop through errors and print out interesting details about them.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>errors</span><span class=p>)</span> <span class=p>&gt;</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>errors</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>circError</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>errors</span><span class=p>[</span><span class=nx>i</span><span class=p>].(</span><span class=o>*</span><span class=nx>resolver</span><span class=p>.</span><span class=nx>ResolvingError</span><span class=p>);</span> <span class=nx>ok</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Message: %s\n--&gt; Loop starts line %d | Polymorphic? %v\n\n&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>circError</span><span class=p>.</span><span class=nf>Error</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=nx>circError</span><span class=p>.</span><span class=nx>CircularReference</span><span class=p>.</span><span class=nx>LoopPoint</span><span class=p>.</span><span class=nx>Node</span><span class=p>.</span><span class=nx>Line</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>circError</span><span class=p>.</span><span class=nx>CircularReference</span><span class=p>.</span><span class=nx>IsPolymorphicResult</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Which will print something like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Message: Circular reference detected: file: person -&gt; legal_entity_person_verification -&gt; legal_entity_person_verification_document -&gt; file -&gt; file_link -&gt; file [8893:15]
</span></span><span class=line><span class=cl>--&gt; Loop starts line 8893 | Polymorphic? true
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Message: Circular reference detected: bank_account: payment_intent -&gt; customer -&gt; bank_account -&gt; account -&gt; bank_account [2291:23]
</span></span><span class=line><span class=cl>--&gt; Loop starts line 2291 | Polymorphic? true
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><hr><h2 id=what-about-parsing-swagger-specifications>What about parsing Swagger specifications?</h2><p>If <a href=https://swagger.io/specification/v2/>Swagger (OpenAPI 2)</a> is something you&rsquo;re still using,
I <strong>recommend upgrading</strong> to <a href=https://spec.openapis.org/oas/v3.1.0>OpenAPI version. 3.1</a></p><p>However, if that&rsquo;s something that you can&rsquo;t do, then <a href=https://github.com/pb33f/libopenapi>libopenapi</a> has got you covered.</p><p>The process is the same as building an OpenAPI 3+ document; however, call <code>BuildV2Model()</code> instead.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// for a v2 (Swagger) specification, build a v2 model
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>swaggerDocModel</span><span class=p>,</span> <span class=nx>errors</span> <span class=o>:=</span> <span class=nx>document</span><span class=p>.</span><span class=nf>BuildV2Model</span><span class=p>()</span>
</span></span></code></pre></div><p><a href=https://github.com/pb33f/libopenapi>libopenapi</a> will render a different model.
Swagger differs in many ways from OpenAPI, so most of the model is not shared.</p><hr><p>Read the full docs for <a href=https://github.com/pb33f/libopenapi>libopenapi</a> at <a href=https://pkg.go.dev/github.com/pb33f/libopenapi>pkg.go.dev</a></p></section><hr><nav class=go-back-parent-link><a href=https://quobix.com/articles/>&lt; Back to Articles</a></nav></article></main></div><footer class=footer><a href=https://quobix.com/author>Dave Shanley</a> &copy;2007-2023
<span class=generated-timestamp>[generated 01/01/23 15:18 UTC]</span></footer></div></body></html>