<!doctype html><html lang=en><head><script type=application/ld+json>{"@context":"https://schema.org","@type":"NewsArticle","headline":"vacuum: Custom RuleSets","image":["https:\/\/quobix.com\/"],"datePublished":"2022-07-01 05:30:17 -0400 -0400","author":{"@type":"Person","name":"Dave Shanley","url":"https://quobix.com/author"}}</script><meta charset=utf-8><link rel=apple-touch-icon sizes=180x180 href=https://quobix.com//apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://quobix.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://quobix.com/favicon-16x16.png><meta name=description content="quobix::vaccum, The worlds fastest OpenAPI linter. How to define custom RuleSets
"><meta charset=utf-8><meta name=keywords content="OpenAPI,swagger,spectral,linting,linter,vacuum,dave shanley,shanley,code,golang,java,javascript,typescript,quobix,engineer"><link crossorigin=use-credentials rel=manifest href=https://quobix.com/site.webmanifest><meta name=author content="Dave Shanley"><meta name=viewport content="width=device-width,initial-scale=1"><title>vacuum OpenAPI Linter: Custom RuleSets</title><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-PC979K2")</script><link rel=preload href=https://quobix.com/assets/bundle.js as=script><script src=https://quobix.com/assets/bundle.js></script><style>:root{--global-font-size:17px;--toc-font-size:0.7rem;--breadcrumb-font-size:0.75rem;--childnav-font-size:0.75rem;--nav-font-size:0.95rem;--toc-font-header-size:0.85rem;--rule-item-header-fontsize:1.2rem;--rule-item-header-fontsize-mobile:1rem;--rule-item-details-fontsize:0.8rem;--rule-format-fontsize:0.8rem;--rule-type-fontsize:0.7rem;--rule-severity-fontsize:0.8rem;--rule-recommended-fontsize:0.7rem;--rule-function-fontsize:0.8rem;--rule-recommended-banner-fontsize:1rem;--rule-panel-label:0.7rem;--rule-id-fontsize:2rem;--rule-id-fontsize-mobile:1.3rem;--global-line-height:1.4em;--global-space:10px;--vacuum-navigation-width-v:199px;--vacuum-navigation-width:200px;--font-stack:Menlo, Monaco, Roboto Mono, Lucida Console, Liberation Mono,
            DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace,
            serif;--mono-font-stack:Menlo, Monaco, Roboto Mono, Lucida Console, Liberation Mono,
            DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace,
            serif;--background-color:#0d1117;--background-color-alpha:rgba(13, 17, 23, 0.80);--background-color-alpha-mobile:rgba(13, 17, 23, 0.99);--rule-item-background:rgba(26, 32, 44, 0.51);--rule-recommended-background:rgb(33, 41, 55);--rule-stats-background:#0a0a0a;--rule-item-border:rgba(35, 43, 58, 0.9);--navigation-hover:#b685ff33;--navigation-child-selected:rgba(182, 133, 255, 0.36);--navigation-child-hover:rgba(179, 131, 250, 0.09);--navigation-child-container:linear-gradient(180deg, rgba(0,0,0,1) 0%, rgba(182,133,255,0.2) 50%);--vacuum-online-results-background:linear-gradient(180deg, rgba(13, 17, 23,1) 0%, rgba(223, 222, 225, 0.12) 50%);--page-width:65em;--font-color:#e8e9ed;--invert-font-color:#222225;--secondary-color:#f83aff;--secondary-color-lowalpha:rgba(248, 58, 255, 0.30);--secondary-color-very-lowalpha:rgba(182, 133, 255, 0.23);--secondary-color-shadow:rgb(59, 41, 87);--secondary-color-shadow-mid:rgb(78, 54, 114);--tertiary-color:#a3abba;--terminal-border:rgba(76, 81, 91, 0.5);--terminal-header-background:linear-gradient(90deg, rgba(76, 81, 91, 0.5) 0%, rgba(76, 81, 91, 0.1) 80%);--primary-color:rgba(98, 196, 255, 1.0);--primary-color-lowalpha:rgba(98, 196, 255, 0.6);--error-color:#ff3c74;--error-font-color:#ff246b;--error-color-lowalpha:rgba(255, 60, 116, 0.4);--progress-bar-background:#0a0a0a;--progress-bar-fill:#62c4ff;--code-bg-color:none;--input-style:solid;--display-h1-decoration:none;--bold-text:#f83aff;--terminal-green:#00FF00FF;--terminal-yellow:#fddb00;--hrcolor:#3d3d3d;--code-border:#525252;--string-literal:#fd66e5;--warn-400:#ff6a00;--warn-400-lowalpha:rgba(255, 106, 0, 0.15);--warn-300:#ff9900;--warn-300-lowalpha:rgba(255, 153, 0, 0.05);--warn-200:#ffb700;--warn-200-lowalpha:rgba(255, 183, 0, 0.15);--warn-color:#ffd500;--warn-color-lowalpha:rgba(255, 213, 0, 0.15);--ok-400:#f7ff00;--ok-400-lowalpha:rgba(230, 255, 0, 0.15);--ok-300:#d0ff00;--ok-300-lowalpha:rgba(208, 255, 0, 0.15);--ok-200:#aaff00;--ok-200-lowalpha:rgba(170, 255, 0, 0.15);--ok-color:#1aff00;--ok-color-lowalpha:rgba(170, 255, 0, 0.15)}</style><link rel=stylesheet href=https://quobix.com/assets/syntax.css><link rel=stylesheet href=https://quobix.com/assets/app.css><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="vacuum OpenAPI Linter: Custom RuleSets"><meta property="og:description" content="How to define custom RuleSets
"><meta property="og:publish_date" content="2022-07-01 05:30:17 -0400 -0400"><meta property="og:url" content="https://quobix.com/vacuum/rulesets/custom-rulesets/"><meta property="og:site_name" content="quobix"><meta property="og:image" content="https://quobix.com/images/vacuum/logo-blackbg.png"><meta property="og:image:width" content="1400"><meta property="og:image:height" content="680"><meta property="og:image:secure_url" content="https://quobix.com/images/vacuum/logo-blackbg.png"><meta property="og:image:type" content="image/png"><meta property="og:image:alt" content="https://quobix.com/images/vacuum/logo-blackbg.png"><meta property="article:author" content="https://quobix.com"><meta property="article:publisher" content="https://quobix.com"><meta property="article:section" content="Software"><meta property="article:published_time" content="2022-07-01 05:30:17 -0400 -0400"><meta property="article:modified_time" content="2022-07-01 05:30:17 -0400 -0400"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@daveshanley"><meta name=twitter:creator content="@daveshanley"><meta name=twitter:label1 content="Written by"><meta name=twitter:data1 content="Dave Shanley"><link rel=stylesheet href=https://quobix.com/assets/vacuum.css></head><body class=terminal><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PC979K2" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><div class=quobix-header><section class=terminal-nav id=main-navigation><header class=terminal-logo><div class="logo terminal-prompt"><a href=https://quobix.com/>quobix</a><span class=vacuum-sep>::</span><span class=vacuum-title>vacuum</span></div></header><nav class=terminal-menu id=header-menu><ul itemscope itemtype=http://schema.org/BreadcrumbList><li itemprop=itemListElement itemscope itemtype=http://schema.org/ListItem><a href=https://quobix.com/articles/ itemprop=item class=menu-item><span itemprop=name>Articles</span><meta itemprop=position content="1"></a></li><li itemprop=itemListElement itemscope itemtype=http://schema.org/ListItem><a href=https://quobix.com/author/ itemprop=item class=menu-item><span itemprop=name>Author</span><meta itemprop=position content="2"></a></li><li itemprop=itemListElement itemscope itemtype=http://schema.org/ListItem><a href=https://quobix.com/vacuum/ itemprop=item class=menu-item><span itemprop=name>vacuum</span><meta itemprop=position content="3"></a></li></ul></nav></section><hr id=top-nav-divider></div><div class=container><div class=main-container><main class=content-container><nav class=vacuum-navigation><div class=fixed-position><a href=https://quobix.com/vacuum/start class=quick-start-navigation>Quick Start Guide&nbsp;</a><hr class=quick-start-divider><vacuum-desktop-navigation><vacuum-nav-item url=https://quobix.com/vacuum/installing/ name=Installing></vacuum-nav-item></vacuum-nav-item>
<vacuum-nav-item url=https://quobix.com/vacuum/about/ name="About vacuum"></vacuum-nav-item>
<vacuum-nav-item url=https://quobix.com/vacuum/why/ name=Why?></vacuum-nav-item>
<vacuum-nav-item url=https://quobix.com/vacuum/concepts/ name=Concepts></vacuum-nav-item>
<vacuum-nav-item url=https://quobix.com/vacuum/demo/ name="Online Demo ðŸª„"></vacuum-nav-item>
<vacuum-nav-item url name="CLI Commands"><ul class=navigation-children><li class=child-nav><a href=https://quobix.com/vacuum/commands/lint/>Lint</a></li><li class=child-nav><a href=https://quobix.com/vacuum/commands/report/>vacuum Report</a></li><li class=child-nav><a href=https://quobix.com/vacuum/commands/dashboard/>Dashboard</a></li><li class=child-nav><a href=https://quobix.com/vacuum/commands/html-report/>HTML Report</a></li><li class=child-nav><a href=https://quobix.com/vacuum/commands/spectral-report/>Spectral Report</a></li><li class=child-nav><a href=https://quobix.com/vacuum/commands/external-references/>External References</a></li></ul></vacuum-nav-item><vacuum-nav-item url name="Developer API"><ul class=navigation-children><li class=child-nav><a href=https://quobix.com/vacuum/api/getting-started/>API Quick Start</a></li><li class=child-nav><a href=https://quobix.com/vacuum/api/spec-index/>Spec Index</a></li><li class=child-nav><a href=https://quobix.com/vacuum/api/rule-resultset/>RuleResultSet</a></li><li class=child-nav><a href=https://quobix.com/vacuum/api/loading-ruleset/>Loading RuleSet</a></li><li class=child-nav><a href=https://quobix.com/vacuum/api/custom-functions/>Custom Functions</a></li></ul></vacuum-nav-item><vacuum-nav-item url name=Functions><ul class=navigation-children><li class=child-nav><a href=https://quobix.com/vacuum/functions/core/>Core Functions</a></li><li class=child-nav><a href=https://quobix.com/vacuum/functions/openapi/>OpenAPI Functions</a></li></ul></vacuum-nav-item><vacuum-nav-item url name=Rules><ul class=navigation-children><li class=child-nav><a href=https://quobix.com/vacuum/rules/examples/>Examples</a></li><li class=child-nav><a href=https://quobix.com/vacuum/rules/operations/>Operations/Paths</a></li><li class=child-nav><a href=https://quobix.com/vacuum/rules/schemas/>Schemas</a></li><li class=child-nav><a href=https://quobix.com/vacuum/rules/information/>Spec Information</a></li><li class=child-nav><a href=https://quobix.com/vacuum/rules/validation/>Validation</a></li><li class=child-nav><a href=https://quobix.com/vacuum/rules/descriptions/>Descriptions</a></li><li class=child-nav><a href=https://quobix.com/vacuum/rules/tags/>Tags</a></li><li class=child-nav><a href=https://quobix.com/vacuum/rules/security/>Security</a></li></ul></vacuum-nav-item><vacuum-nav-item url name=RuleSets open><ul class=navigation-children><li class=child-nav><a href=https://quobix.com/vacuum/rulesets/understanding/>Understanding RuleSets</a></li><li class=child-nav><a href=https://quobix.com/vacuum/rulesets/all/>All Rules</a></li><li class=child-nav><a href=https://quobix.com/vacuum/rulesets/no-rules/>No Rules/Off</a></li><li class=child-nav><a href=https://quobix.com/vacuum/rulesets/recommended/>Recommended Rules</a></li><li class=active-child-nav>Custom RuleSets</li></ul></vacuum-nav-item></vacuum-desktop-navigation><hr class=nav-divider><a class=github-link href=https://github.com/daveshanley/vacuum>GitHub</a>
<img class=nav-badge alt="GitHub Repo stars" src="https://img.shields.io/github/stars/daveshanley/vacuum?color=%23b685ff&style=flat-square"><br><a class=discord-link href=https://discord.gg/UAcUF78MQN>Discord</a>
<img class=nav-badge-discord alt=Discord src="https://img.shields.io/discord/923258363540815912?color=%23b685ff&style=flat-square"></div></nav><mobile-nav><ul class=mobile-nav><li class=mobile-nav><a href=https://quobix.com/vacuum/installing/>Installing</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/start/>Quick Start</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/about/>About vacuum</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/why/>Why?</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/concepts/>Concepts</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/demo/>Online Demo ðŸª„</a></li><li class=mobile-nav>CLI Commands<ul><li class=mobile-nav><a href=https://quobix.com/vacuum/commands/lint/>Lint</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/commands/report/>vacuum Report</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/commands/dashboard/>Dashboard</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/commands/html-report/>HTML Report</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/commands/spectral-report/>Spectral Report</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/commands/external-references/>External References</a></li></ul></li><li class=mobile-nav>Developer API<ul><li class=mobile-nav><a href=https://quobix.com/vacuum/api/getting-started/>API Quick Start</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/api/spec-index/>Spec Index</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/api/rule-resultset/>RuleResultSet</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/api/loading-ruleset/>Loading RuleSet</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/api/custom-functions/>Custom Functions</a></li></ul></li><li class=mobile-nav>Functions<ul><li class=mobile-nav><a href=https://quobix.com/vacuum/functions/core/>Core Functions</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/functions/openapi/>OpenAPI Functions</a></li></ul></li><li class=mobile-nav>Rules<ul><li class=mobile-nav><a href=https://quobix.com/vacuum/rules/examples/>Examples</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/rules/operations/>Operations/Paths</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/rules/schemas/>Schemas</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/rules/information/>Spec Information</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/rules/validation/>Validation</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/rules/descriptions/>Descriptions</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/rules/tags/>Tags</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/rules/security/>Security</a></li></ul></li><li class=mobile-nav>RuleSets<ul><li class=mobile-nav><a href=https://quobix.com/vacuum/rulesets/understanding/>Understanding RuleSets</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/rulesets/all/>All Rules</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/rulesets/no-rules/>No Rules/Off</a></li><li class=mobile-nav><a href=https://quobix.com/vacuum/rulesets/recommended/>Recommended Rules</a></li><li class="mobile-nav active-section"><a href=https://quobix.com/vacuum/rulesets/custom-rulesets/>Custom RuleSets</a></li></ul></li><hr class=mobile-nav-divider><li class=mobile-nav><a href=https://github.com/daveshanley/vacuum>GitHub</a>
<img class=nav-badge alt="GitHub Repo stars" src="https://img.shields.io/github/stars/daveshanley/vacuum?color=%23b685ff&style=flat-square"></li><li class=mobile-nav><a href=https://discord.gg/UAcUF78MQN>Discord</a>
<img class=nav-badge-discord alt="Discord Server" src="https://img.shields.io/discord/923258363540815912?color=%23b685ff&style=flat-square"></li></ul></mobile-nav><section class=vacuum-content><div class=breadcrumbs><ul itemscope itemtype=http://schema.org/BreadcrumbList><li itemprop=itemListElement itemscope itemtype=http://schema.org/ListItem><a itemprop=item typeof="WebPage" href=https://quobix.com/vacuum/><span itemprop=name>vacuum</span><meta itemprop=position content="3"></a></li><li itemprop=itemListElement itemscope itemtype=http://schema.org/ListItem><a itemprop=item typeof="WebPage" href=https://quobix.com/vacuum/rulesets/><span itemprop=name>Understanding RuleSets</span><meta itemprop=position content="2"></a></li><li class=crumb-active itemprop=itemListElement itemscope itemtype=http://schema.org/ListItem><a itemprop=item typeof="WebPage" href=https://quobix.com/vacuum/rulesets/custom-rulesets/><span itemprop=name>Custom RuleSets</span><meta itemprop=position content="1"></a></li></ul></div><article class=framed-content><h1 class=article-title>Custom RuleSets</h1><div class=article-strapline><em>At some-point, we all want to specialize.</em></div><section class=article-body><hr><p>Most of the time, just customizing the <a href=https://quobix.com/vacuum/rules/>built-in OpenAPI Rules</a> will get about
90% of the job done, most of the time.</p><p>At some point however, there comes a time to customize the rules and perhaps add some new ones using
<a href=https://quobix.com/vacuum/functions/core/>built-in core functions</a>.</p><hr><h2 id=dont-design-apis-in-a-wiki>Don&rsquo;t design APIs in a wiki.</h2><p>Most big companies are guaranteed to have wiki pages in Confluence (or similar), that have HTTP REST APIs that are
inconsistently documented, invalid and out-of-date. Nobody reads this content, it&rsquo;s mostly a waste of time.</p><p>This is a <strong>terrible way to operate</strong>.</p><h2 id=use-a-ruleset>Use a RuleSet!</h2><p>Using a RuleSet will ensure that your APIs are always consistent, valid, clean and useful. RuleSets are a <strong>style guide</strong>
that has been codified into logic.</p><h2 id=adding-rules>Adding Rules</h2><p>To create a RuleSet, you simply need to start a new <code>ruleset.yaml</code> (you can call the file what ever you want) and then
create a new rule under a <code>rules</code> node at the root of the document. For example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>my-new-rule</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;check the title is exactly &#39;hello world&#39;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>given</span><span class=p>:</span><span class=w> </span><span class=l>$.info.title</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>severity</span><span class=p>:</span><span class=w> </span><span class=l>error</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>then</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>function</span><span class=p>:</span><span class=w> </span><span class=l>pattern</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>functionOptions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>match</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;^hello world$&#34;</span><span class=w>
</span></span></span></code></pre></div><p>Now it&rsquo;s possible to run this new RuleSet against any vacuum command.</p><p><code>lint</code> example:</p><terminal-window><terminal-header>lint with ruleset</terminal-header>
<terminal-command command="vacuum lint -r ruleset.yaml my-openapi-spec.yaml" cliname=vacuum clicommand=lint flags=-r></terminal-command></terminal-window><p><code>html-report</code> example:</p><terminal-window><terminal-header>lint with ruleset</terminal-header>
<terminal-command command="vacuum html-report -r ruleset.yaml my-openapi-spec.yaml" cliname=vacuum clicommand=html-report flags=-r></terminal-command></terminal-window><p>vacuum lint -r ruleset.yaml my-openapi-spec.yaml
Every single OpenAPI spec on the planet, should fail this rule; unless the title really is &lsquo;<em>hello world</em>&rsquo;.</p><h2 id=anatomy-of-a-rule>Anatomy of a Rule</h2><p>vacuum is compatible with <a href=https://meta.stoplight.io/docs/spectral/e5b9616d6d50c-custom-rulesets>Spectral Rule Properties</a>.</p><h3 id=given>Given</h3><p>The <code>given</code> property is a selector. It&rsquo;s a <a href=http://jsonpath.com/>JSONPath</a> value that identifies where in the
document the node can be found.</p><p>It&rsquo;s similar to XPath, but uses slightly different syntax. <a href=http://jsonpath.com/>JSONPath</a> is not a standard yet, so
there are varying implementations of it.</p><p>vacuum uses YAML deep down, and to find things using JSONPath, it converts that into YAMLPath using a neat library from
my old employer called <a href=https://github.com/vmware-labs/yaml-jsonpath>yaml-jsonpath</a>.
To learn more about the syntax vacuum supports, check it out.</p><p>Need some help checking a path is valid? Use the <a href=http://jsonpath.com/>JSONPath Evaluator</a> for help to get it right.</p><h3 id=severity>Severity</h3><p>The <code>severity</code> property is optional, it can be one of the following: <code>error</code>, <code>warn</code>, <code>info</code> or <code>hint</code>. If left blank
the default is <code>warn</code>.</p><h3 id=resolved>Resolved</h3><p>Before we discuss what this is, let&rsquo;s take a quick look at what a <em>resolver</em> is:</p><div class=terminal-card><header>What is a resolver? What does it do?</header><div><p>What does <em>resolved</em> actually mean? <a href=https://json-schema.org/>JSONSchema</a> allows <strong>$ref</strong> properties. These properties
&lsquo;point&rsquo; to another schema definition. It allows us to re-use schemas.</p><p>These references can be local (in the same file), or they can be remote (another file). Remote can mean both on a
completely different file system, or the same file system.</p><p>A resolver is responsible for looking up each reference, and then &lsquo;pulling in&rsquo; those referenced schemas in-place of
the <strong>$ref</strong> value that has been presented.</p></div></div><p>A <em>resolved</em> document, is one that has no <strong>$ref</strong> values anymore, they have all been replaced with the referenced schemas.</p><h4 id=but-i-need-an-un-resolved-document>But I need an un-resolved document</h4><p>Sometimes, and for some use cases you do. A good example of this is the <a href=https://quobix.com/vacuum/rules/schemas/no-ref-siblings/>no-$ref-siblings</a> Rule
that cannot operate correctly if all <strong>$ref</strong> values have been removed.</p><p>If a rule needs to access the raw <strong>$ref</strong> reference values, set <code>resolved</code> to <code>false</code> allowing the rule to receive
the raw un-resolved version of the spec.</p><p>If you leave <code>resolved</code> blank, it will default to <code>true</code>.</p><blockquote><p>Generally, <strong>resolved</strong> documents are going to be what you want to use.</p></blockquote><h3 id=then>Then</h3><p>This is the fun part, <code>then</code> defines what <a href=https://quobix.com/vacuum/functions/>function</a> to run against the JSONPath
defined by <a href=#given><code>given</code></a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>given</span><span class=p>:</span><span class=w> </span><span class=l>$.servers[*].url</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>then</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>function</span><span class=p>:</span><span class=w> </span><span class=l>truthy</span><span class=w>
</span></span></span></code></pre></div><p>There is one required keyword: <code>function</code>. <code>field</code> is <em>optional</em>. It&rsquo;s generally only used for
<a href=https://quobix.com/vacuum/functions/core/>core functions</a>.</p><div class="terminal-alert terminal-alert-primary">If you omit the <code>field</code> value, the path defined by <code>given</code> will be the node value used.</div><p>Some core functions like <a href=https://quobix.com/vacuum/functions/core/pattern/>pattern</a>,
<a href=https://quobix.com/vacuum/functions/core/schema/>schema</a>and <a href=https://quobix.com/vacuum/functions/core/enumeration/>enumeration</a>
accept arguments via the <code>functionOptions</code> property.</p><h4 id=function-options>Function Options</h4><p><code>functionOptions</code> presents arguments to the function defined to handle the rule.</p><p>The <a href=https://quobix.com/vacuum/functions/core/pattern/>pattern</a> function accepts <code>match</code> or <code>notMatch</code> arguments, for example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>check-host-rule</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Host URL should not contain a trailing slash&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>given</span><span class=p>:</span><span class=w> </span><span class=l>$.servers[*]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>then</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>field</span><span class=p>:</span><span class=w> </span><span class=l>url</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>function</span><span class=p>:</span><span class=w> </span><span class=l>pattern</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>functionOptions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>notMatch</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/$&#34;</span><span class=w>
</span></span></span></code></pre></div><h2 id=modifying-rules>Modifying Rules</h2><p>If your custom RuleSet is the <a href=https://quobix.com/vacuum/rulesets/recommended/>recommended</a> or <a href=https://quobix.com/vacuum/rulesets/all/>all</a>
RuleSet, you can replace a rule that has already been defined with your own custom rule, or you can <strong>&lsquo;override&rsquo;</strong>
individual properties.</p><p>For example, to modify the existing <a href=https://quobix.com/vacuum/rules/information/oas3-host-not-example/>oas3-host-host-example</a>
rule, to look for something other than &rsquo;example.com&rsquo;, you could add this rule configuration to your custom RuleSet.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=p>[[</span><span class=l>spectral:oas, recommended]]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>oas3-host-not-example</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;check server URL is not testy.mctest-face.com&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>given</span><span class=p>:</span><span class=w> </span><span class=l>$.servers[*].url</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>then</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>function</span><span class=p>:</span><span class=w> </span><span class=l>pattern</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>functionOptions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>notMatch</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;testy\\.mctest-face\\.com&#34;</span><span class=w>
</span></span></span></code></pre></div><p>If you just want the severity of the rule, there is a <strong>shortcut</strong>.</p><h2 id=changing-rule-severity>Changing Rule Severity</h2><p>If you want to use <a href=https://quobix.com/vacuum/rulesets/recommended/>recommended</a> or <a href=https://quobix.com/vacuum/rulesets/all/>all</a>
RuleSets, but you want to change a rule&rsquo;s severity from a <code>error</code> to a <code>warn</code> to trigger a warning, instead of an error.</p><p>In this case, you don&rsquo;t need to re-declare the rule, you can simply add the <a href=#severity>severity</a> value to the rule name.
For example, to change the severity of [operation-operationId] from an <em>error</em> to a <em>warning</em>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=p>[[</span><span class=l>spectral:oas, recommended]]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>operation-operationId</span><span class=p>:</span><span class=w> </span><span class=l>warn</span><span class=w>
</span></span></span></code></pre></div><h2 id=disabling-rules>Disabling Rules</h2><p>To turn the rule off completely: use <code>off</code> as the severity, for example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=p>[[</span><span class=l>spectral:oas, recommended]]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>operation-operationId</span><span class=p>:</span><span class=w> </span><span class=kc>off</span><span class=w>
</span></span></span></code></pre></div><h2 id=enabling-rules>Enabling Rules</h2><p>If you already have an existing OpenAPI specification, and you run it through vacuum, chances are that you&rsquo;re going to
see a number of warnings and perhaps some errors.</p><p>This overload of data can be a bit much. So the next thing you will probably want to do, turn of all the rules, and enable
just the ones you want, as you slowly improve the quality of your specification.</p><p>vacuum has a built in <a href=https://quobix.com/vacuum/rulesets/no-rules/>no rules</a> RuleSet that turns off everything, (it&rsquo;s an empty
RuleSet). This will allow individual rules to be turned on/enabled.</p><p>For example, to enable just the <a href=https://quobix.com/vacuum/rules/operations/operation-operationid/>operation-operationId</a>
and <a href=https://quobix.com/vacuum/rules/information/info-contact/>info-contact</a> Rules, then your RuleSet would look like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=p>[[</span><span class=l>spectral:oas, off]]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>operation-operationId</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>info-contact</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span></code></pre></div><h2 id=documentation-url>Documentation URL</h2><p>If you&rsquo;re going to share your RuleSet (awesome!), you might want to fill out the <code>documentationUrl</code> properties for
your RuleSet. This is used by vacuum to render links to more details about <strong>why</strong> the ruleset exists, and what its purpose is.</p><p>Often, a description is not enough, and we need docs, use the <code>documentationUrl</code> property.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=p>[[</span><span class=l>spectral:oas, off]]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>documentationUrl</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;https://quobix.com/vacuum/rulesets/custom-rulesets#documentation-url&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>operation-operationId</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>info-contact</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span></code></pre></div><p>You can also add the URL to your rules as well, so there is more granular access to specific docs:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=p>[[</span><span class=l>spectral:oas, off]]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>documentationUrl</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;https://quobix.com/vacuum/rulesets/custom-rulesets&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>oas3-host-not-example</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>documentationUrl</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;https://quobix.com/vacuum/rules/information&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;check server URL is not testy.mctest-face.com&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>given</span><span class=p>:</span><span class=w> </span><span class=l>$.servers[*].url</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>then</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>function</span><span class=p>:</span><span class=w> </span><span class=l>pattern</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>functionOptions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>notMatch</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;testy\\.mctest-face\\.com&#34;</span><span class=w>
</span></span></span></code></pre></div><h2 id=how-to-fix>How To Fix</h2><p>vacuum adds a new property called <code>howToFix</code>. This is a string explanation of how to fix the problem when a rule
is violated. The fix is rendered in the console UI and html-report functions.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=p>[[</span><span class=l>spectral:oas, off]]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>oas3-host-not-example</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>howToFix</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Make sure the host name is not example.com, change it!&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>...</span><span class=w>
</span></span></span></code></pre></div></section></article></section><div class=right-nav><aside class=table-of-contents><p>What's on this page</p><nav id=TableOfContents><ul><li><a href=#dont-design-apis-in-a-wiki>Don&rsquo;t design APIs in a wiki.</a></li><li><a href=#use-a-ruleset>Use a RuleSet!</a></li><li><a href=#adding-rules>Adding Rules</a></li><li><a href=#anatomy-of-a-rule>Anatomy of a Rule</a><ul><li><a href=#given>Given</a></li><li><a href=#severity>Severity</a></li><li><a href=#resolved>Resolved</a></li><li><a href=#then>Then</a></li></ul></li><li><a href=#modifying-rules>Modifying Rules</a></li><li><a href=#changing-rule-severity>Changing Rule Severity</a></li><li><a href=#disabling-rules>Disabling Rules</a></li><li><a href=#enabling-rules>Enabling Rules</a></li><li><a href=#documentation-url>Documentation URL</a></li><li><a href=#how-to-fix>How To Fix</a></li></ul></nav></aside></div></main></div><footer class=footer><a href=https://quobix.com/author>Dave Shanley</a> &copy;2007-2023
<span class=generated-timestamp>[generated 05/27/23 17:34 UTC]</span></footer></div></body></html>